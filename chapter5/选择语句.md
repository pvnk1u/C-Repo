# 选择语句

尽管C语言有许多运算符，但是它所拥有的语句却相对较少。到目前为止，只见过两种语句：return语句和表达式语句（第四章）。根据对语句执行顺序的影响，C语言的其余语句大多属于以下3大类：

- 选择语句

  if语句和switch语句允许程序在一组可选项选择一条特定的执行路径

- 重复语句

  while语句、do语句和for语句支持重复（循环）操作

- 跳转语句

  break语句、continue语句和goto语句导致无条件跳转到程序中的某个位置（return语句也属于此类）



C语言还有其他两类语句，一类是复合语句（把几条语句组合成一条语句），一类是空语句（不执行任何操作）。



本章讨论选择语句和复合语句。



## 逻辑表达式

包括if语句在内的某些C语句都必须测试表达式的值是“真”还是“假”。例如，if语句可能需要检测表达式`i<j`，真值将说明i是小于j的。在某些编程语言中，类似i < j 这样的表达式都具有特殊的“布尔”类型或“逻辑”类型。这样的类型只有两个值，即假和真。而**在C语言中，诸如`i<j`这样的比较运算会产生整数：0(假)或1(真)。**



### 关系运算符

C语言的关系运算符和数学上的<、>、≤和≥运算符相对应，只是用在C语言的表达式中时产生的结果是0（假）或1（真）。例如，表达式 10<11的值为1。



关系运算符可以用于比较整数和浮点数，也允许比较混合类型的操作数。因此，表达式1<2.5的值为1，而表达式5.6<4的值为0。



关系运算符的优先级低于算术运算符。例如，表达式i+j < k-1的意思是(i+k) < (k-1)。关系运算符都是左结合的。



### 判等运算符

C语言中表示关系运算符的符号与其他许多编程语言中的相同。“等于“运算符是两个紧邻的=字符，一个单独的=字符代表的是赋值运算符。”不等于“运算符也是两个字符，即`!=`。



和关系运算符一样，判等运算符也是左结合的，也是产生0（假）或1（真）作为结果。然而，判等运算符的优先级低于关系运算符。例如，表达式i<j == j<k等价于表达式（i<j） == (j < k)。



### 逻辑运算符

利用逻辑运算符 与、或和非，较简单的表达式可以构建出更加复杂的逻辑表达式。!是一元运算符，而&&和||是二元运算符。



运算符&&和运算符||都对操作数进行”短路“计算。





## if语句

if语句允许程序通过测试表达式的值从两种选项中选择一种。if语句的最简单格式如下：

```c
[if语句] 	if(表达式)语句
```

下面是一个示例：

```c
if(line_num == MAX_LINES)
	line_num = 0;
```

如果条件line_num == MAX_LINES为真（有非零值），那么执行语句line_num = 0;。



if语句中可以使用复合语句来处理多条语句：

```c
if(line_num == MAX_LINES){
	line_num = 0;
	page_num++;
}
```



if语句可以使用级联式语句:

```c
if(n <0){
	printf("n is less than 0\n");
}else if(n == 0){
	printf("n is equals to 0\n");
}else{
	printf("n is greater than 0\n");
}
```





### 计算股票经纪人的佣金

当股票通过经纪人进行买卖时，经纪人的佣金往往根据股票交易额采用某种变化的比例进行计算。下面的表格显示了实际支付给经纪人的费用数量。

| 交易额范围       | 佣金数量      |
| ---------------- | ------------- |
| 低于2500美元     | 30美元+1.7%   |
| 2500~6250美元    | 56美元+0.66%  |
| 6250~20000美元   | 76美元+0.34%  |
| 20000~50000美元  | 100美元+0.22% |
| 50000~500000美元 | 155美元+0.11% |
| 超过500000美元   | 255美元+0.09% |



最低收费是39美元。下面的程序要求用户录入交易额，然后显示出佣金的数额：

```
Enter value of trade: 30000
Commission: $166.00
```

完整程序如下：

```c
#include <stdio.h>

int main(void) {
   float commission,value;

    printf("Enter value of trade: ");
    scanf("%f",&value);

    if (value < 2500.f)
        commission = 30.00f + .017f * value;
    else if(value < 6250.00f)
        commission = 56.00f + .0066f*value;
    else if(value < 20000.00f)
        commission = 76.00f + .0034f * value;
    else if(value < 50000.00f)
        commission = 100.00f + .0022f * value;
    else if(value < 500000.00f)
        commission  = 155.00f + .0011f * value;
    else
        commission = 255.00f + .0009f * value;

    if (commission < 39.00f)
        commission = 39.00f;

    printf("Commission:$%.2f\n",commission);
    return 0;
}
```



### “悬空else”的问题

当if语句嵌套时，千万当心著名的“悬空else”的问题。



当if语句嵌套时，千万当心著名的“悬空else”的问题。思考下面这个例子：

```c
if(y != 0)
	if(x != 0)
		result = x/ y;
else
	printf("Error: y is equals to 0\n");
```

上面的else子句究竟属于哪一个if语句呢？缩进格式暗示它属于最外层的if语句。然而，C语言遵循的规则是else子句应该属于离它最近的且还未和其他else匹配的if语句。然而，C语言遵循的规则是else子句应该属于离它最近的且还未和其他else匹配的if语句。在此例中，else子句实际上属于最内层的if语句，所以正确的缩进格式应该如下所示：

```c
if(y != 0)
	if(x != 0)
		result = x / y;
	else 
		printf("Error: y is equals to 0\n");
```

为了使else子句属于最外层的if语句，可以把内层的if语句用花括号括起来：

```c
if(y != 0){
	if(x != 0)
		result = x / y;
} else
	printf("Error: y is equal to 0\n");
```

### 条件表达式

C语言的if语句允许程序根据条件的值来执行两个操作中的一个。C语言还提供了一种特殊的运算符，这种运算符允许表达式依据条件的值产生两个值中的一个。



条件运算符由符号?和符号:组成，两个符号必须按如下格式一起使用：

```
[条件表达式] 表达式1 ? 表达式2 : 表达式3
```

表达式1、表达式2和表达式3可以是任何类型的表达式，按上述方式组合成的表达式称为条件表达式。条件表达式是C运算符中唯一一个要求3个操作数的运算符。因此，经常把它称为三元运算符。



### C89中的布尔值

多年以来，C语言一直缺少适当的布尔类型，C89标准中也没有定义布尔类型。因为许多程序需要变量能存储假或真值，缺少布尔类型可能会有点麻烦。针对C89的这一限制，一种解决方法是先声明一个int型变量，然后将其赋值为0或1：

```c
int flag;

flag = 0;
...
flag = 1;
```

虽然这种方法可行，但是它对于程序的可读性没有多大贡献，因为没有明确地表示flag的赋值只能是布尔值，并且也没有明确指出0和1就是假和真。



为了使程序更加便于理解，C89的程序员通常使用TRUE和FALSE这样的名字定义宏：

```c
#define TRUE 1
#define FALSE 0
```

现在对flag的赋值有了更加自然的形式：

```c
flag = FALSE;
...
flag = TRUE;
```

为了判定flag是否为真，可以用

```c
if(flag == TRUE) ...
```

或者只写

```c
if(flag) ...
```

后一种形式更好，一是更简洁，二是当flag的值不是0或1时程序也能正确运行。



为了判定flag是否为假，可以用

```c
if(flag== FALSE) ...
```

或者

```c
if(!flag)...
```

为了发扬这一思想，甚至可以定义一个可用作类型的宏：

```c
#define BOOL int
```

声明布尔型变量时可以用BOOL代替int：

```c
BOOL flag;
```

现在就非常清楚flag不是普通的整型变量，而是表示布尔条件。（当然，编译器仍然把flag看成是int型变量。）
