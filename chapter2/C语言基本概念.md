# C语言基本概念 



## 编译和链接



虽然pun.c程序十分简短，但是为运行这个程序而包含的内容可能比想象的多。

需要把程序转换为机器可以执行的格式。对于C程序来说，通常包含3个步骤：

1. 预处理

   首先程序会被送交给预处理器（preprocessor）。预处理器执行以#开头的命令（通常称为指令）。预处理器有点类似于编辑器，它可以给程序添加内容，也可以对程序进行修改。

2. 编译

   修改后的程序现在可以进入编译器（compiler）了。编译器会把程序翻译成机器指令（即目标代码）。然而，这样的程序还是不能运行的。

3. 在最后一个步骤中，链接器（linker）把由编译器产生的目标代码和所需的其他附加代码整合到一起，这样才最终产生了完全可执行的程序。这些附加代码包括程序中用到的库函数（如printf函数）。



幸运的是，上述过程往往是自动实现的，事实上，由于预处理器通常会和编译器集成到一起，所以人们甚至可能不会注意到它在工作。



根据编译器和操作系统的不同，编译和链接所需的命令也是多种多样的。在UNIX系统环境下通常把C编译器命名为cc。为了编译和链接pun.c程序，需要在终端录入如下命令：

```shell
cc pun.c
```

在使用编译器cc时，系统会自动进行链接操作，而无需单独的链接命令。



在编译和链接好程序后，编译器会把可执行程序放到默认名为a.out的文件中。编译器cc有许多选项，其中有一个选项（-o选项）允许为含有可执行程序的文件选择名字。例如，假设要把pun.c生成的可执行文件命名为pun，那么只需要录入下列命令：

```shell
cc -o pun pun.c
```



GCC编译器是最流行的C编译器之一，它随Linux发行，但也有面向其他很多平台的版本。这种编译器的使用与传统的UNIX cc编译器类似。例如，编译程序pun.c可以使用如下命令：

```shell
gcc -o pun pun.c
```



## 简单程序的一般形式



### 指令

编译C程序之前，预处理器会首先对其进行编辑。我们把预处理器执行的命令称为指令。这里只关注`#include`指令。



程序`pun.c`由下列这行指令开始：

```c
#include <stdio.h>
```

这条指令说明，在编译前把`<stdio.h>`中的信息包含到程序中。



所有指令都是以字符#开始的。这个字符可以把C程序中的指令和其他代码区分开来。指令默认只占一行，每条指令的结尾没有分号或其他特殊标记。



### 函数

一个C程序可以包含多个函数，但只有main函数是必须有的。main函数是非常特殊的：在执行程序时系统会自动调用main函数。



main函数会在程序终止时向操作系统返回一个状态码。再来看下`pun.c`程序：

```c
#include <stdio.h>

int main(void) {
    printf("To C,or not to C: that is the question.\n");
    return 0;
}

```

main前面的int表明该函数将返回一个整数值。圆括号中的void表明main函数没有参数。语句`return 0;`有两个作用：一是使main函数终止（从而程序结束），二是指出main函数的返回值是0。后面会详细讨论mian函数的返回值。现在始终先让main函数的返回值为0，这个值表示程序正常终止。



## 变量和赋值

大多数程序在产生输出之前需要执行一系列计算，因此需要在程序执行过程中有一种临时存储数据的方法。和大多数编程语言一样，C语言中的这类存储单元被称为变量（variable）。



### 类型

每一个变量都必须有一个类型。C拥有广泛多样的类型。现在先只限定在两种类型范围内：int类型和float类型。由于类型会影响变量的存储方式以及允许对变量进行的操作，所以选择合适的类型是非常关键的。数值型变量的类型决定了变量所能存储的最大值和最小值，同时也决定了是否允许在小数点后出现数字。



int型变量可以存储整数，但是整数的取值范围是受限制的。最大的整数通常是2147483647。



float型变量可以存储比int型变量大得多的数值。而且，float型变量可以存储带小数位的数，但进行算术运算时float型变量通常比int型变量慢；更重要的是，float型变量所存储的数值往往只是实际数值的一个近似值。如果在一个float型变量中存储0.1，以后可能会发现变量的值变为0.09999999999999999997，这是舍入造成的误差。



### 显示变量的值

用printf可以显示出变量的当前值。以

Height: h

为例，可以通过如下的printf调用来输出上述信息：

```c
printf("Height: %d\n",height)
```

占位符%d用来指明在显示过程中变量height的值的显示位置。注意，由于在%d后面放置了\n，所以printf在显示完height的值后会跳到下一行。



%d仅用于int型变量。如果要显示float型变量，需要用%f来代替%d。





