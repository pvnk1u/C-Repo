# 字符串

前几章虽然使用过char类型变量和char类型数组，但是始终没有谈到处理字符序列（术语是字符串）的便捷方法。本章将会补上，并将介绍字符串常量（C标准中称为字符串字面量）和字符串变量。其中，字符串变量可以在程序运行过程中发送改变。



## 字符串字面量

字符串字面量是用一对双引号括起来的字符序列：

```
"When you come to a fork in the road, take it."
```

之前例子中的字符串字面量常常作为格式串出现在printf函数和scanf函数的调用中。



### 字符串字面量中的转义序列

字符串字面量可以像字符常量一样包含转义序列。在printf函数和scanf函数的格式串中已经使用过转义字符。例如，字符串

```
"Candy\nIs dandy\nBut liquor\nIs quicker.\n --Ogden Nash\n"
```

中的每一个字符`\n`都会导致光标移到下一行。



字符串字面量中的八进制数和十六进制数的转义序列也都是合法的，但是它们不像字符转义序列那样常见。



### 如何存储字符串字面量

我们经常在printf函数调用和scanf函数调用中用到字符串字面量。但是，当调用printf函数并且用字符串字面量作为参数时，究竟传递了什么呢？为了回答这个问题，需要明白字符串字面量是如何存储的。



**从本质而言，C语言把字符串字面量作为字符数组来处理。当C语言编译器在程序中遇到长度为n的字符串字面量时，它会为字符串字面量分配长度为n+1的内存空间。这块内存空间将用来存储字符串字面量中的字符，以及一个用来标志字符串末尾的额外字符（空字符）。空字符是一个所有位都为0的字节，因此用转义序列`\0`来表示。**



不要混淆空字符（'\0'）和零字符（'0'）。空字符的码值为0，而零字符则有不同的码值（ASCII中为48）。



例如，字符串字面量“abc”是作为有4个字符的数组来存储的（a、b、c和\0）：

| a    | b    | c    | \0   |
| ---- | ---- | ---- | ---- |



字符串字面量可以为空。字符串“”作为单独一个空字符来存储：`\0`。



既然字符串字面量是作为数组来存储的，那么编译器会把它看作是`char *`类型的指针。例如，printf函数和scanf函数都接收`char *`类型的值作为它们的第一个参数。思考下面的例子：

```c
printf("abc");
```

当调用printf函数时，会传递“abc”的地址（即指向存储字母a的内存单元的指针）。



### 字符串字面量的操作

通常情况下可以在任何C语言允许使用`char *`指针的地方使用字符串字面量。例如，字符串字面量可以出现在赋值运算符的右边：

```c
char *p;

p = "abc";
```

**这个赋值操作不是复制“abc”中的字符，而是使p指向字符串的第一个字符。**



C语言允许对指针取下标，因此可以对字符串字面量取下标：

```c
char ch;

ch = "abc"[1];
```

ch的新值将是字母b。其他可能的下标是0（字母a）、2（字母c）和3（空字符）。